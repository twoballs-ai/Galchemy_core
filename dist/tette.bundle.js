/*! For license information please see tette.bundle.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.TETTECore=e():t.TETTECore=e()}(this,(()=>(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,o(n.key),n)}}function o(t){var e=function(t){if("object"!=r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==r(e)?e:e+""}t.r(e),t.d(e,{Circle:()=>ye,Core:()=>Vt,GameObject:()=>Jt,GraphicalContext:()=>F,KeyboardControl:()=>ht,MouseControl:()=>ii,Rectangle:()=>ie,SceneManager:()=>$t,TouchControl:()=>fi,getShape2d:()=>ei});var i=function(){return t=function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(this instanceof t?this.constructor:void 0)===t)throw new TypeError("Cannot instantiate abstract class Renderer");this.canvas=e.getCanvas(),this.context=e.getContext()},(e=[{key:"clear",value:function(){throw new Error('Метод "clear()" должен быть реализован в подклассе.')}},{key:"render",value:function(t){throw new Error('Метод "render(scene)" должен быть реализован в подклассе.')}}])&&n(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,c(n.key),n)}}function c(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}function f(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(f=function(){return!!t})()}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}var y=function(t){function e(t,r){var n;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,r){return e=l(e),function(t,e){if(e&&("object"==u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,f()?Reflect.construct(e,r||[],l(t).constructor):e.apply(t,r))}(this,e,[t])).backgroundColor=r,!n.backgroundColor)throw new Error("Background color is required for CanvasRenderer.");return n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(e,t),r=e,(n=[{key:"clear",value:function(){this.context.fillStyle=this.backgroundColor,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)}},{key:"drawEntity",value:function(t){t&&"function"==typeof t.render?t.render(this.context):console.error("Object does not have a render method!")}}])&&a(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(i);function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,v(n.key),n)}}function v(t){var e=function(t){if("object"!=h(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==h(e)?e:e+""}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}var w=function(t){function e(t,r){var n;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,r){return e=m(e),function(t,e){if(e&&("object"==h(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,d()?Reflect.construct(e,r||[],m(t).constructor):e.apply(t,r))}(this,e,[t])).backgroundColor=r,!n.backgroundColor)throw new Error("Background color is required for WebGLRenderer.");return n.initializeWebGL(),n.initShaders(),n.createProjectionMatrix(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}(e,t),r=e,(n=[{key:"initializeWebGL",value:function(){var t=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,u,a=[],c=!0,f=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){f=!0,o=t}finally{try{if(!c&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(f)throw o}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return p(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this.backgroundColor,3),e=t[0],r=t[1],n=t[2];this.context.clearColor(e,r,n,1),this.context.enable(this.context.DEPTH_TEST),this.context.depthFunc(this.context.LEQUAL),this.context.viewport(0,0,this.canvas.width,this.canvas.height)}},{key:"initShaders",value:function(){var t=this.loadShader(this.context.VERTEX_SHADER,"\n      attribute vec2 aVertexPosition;\n      attribute vec4 aVertexColor;\n      uniform mat4 uTransform;\n      uniform mat4 uProjection;\n      varying lowp vec4 vColor;\n\n      void main(void) {\n        vec4 position = vec4(aVertexPosition, 0.0, 1.0);\n        gl_Position = uProjection * uTransform * position;\n        vColor = aVertexColor;\n      }\n    "),e=this.loadShader(this.context.FRAGMENT_SHADER,"\n      varying lowp vec4 vColor;\n\n      void main(void) {\n        gl_FragColor = vColor;\n      }\n    ");if(this.shaderProgram=this.context.createProgram(),this.context.attachShader(this.shaderProgram,t),this.context.attachShader(this.shaderProgram,e),this.context.linkProgram(this.shaderProgram),!this.context.getProgramParameter(this.shaderProgram,this.context.LINK_STATUS))return console.error("Не удалось инициализировать шейдерную программу: "+this.context.getProgramInfoLog(this.shaderProgram)),null;this.context.useProgram(this.shaderProgram),this.vertexPositionAttribute=this.context.getAttribLocation(this.shaderProgram,"aVertexPosition"),this.context.enableVertexAttribArray(this.vertexPositionAttribute),this.vertexColorAttribute=this.context.getAttribLocation(this.shaderProgram,"aVertexColor"),this.context.enableVertexAttribArray(this.vertexColorAttribute)}},{key:"createProjectionMatrix",value:function(){var t=this.canvas.width,e=this.canvas.height;this.projectionMatrix=[2/t,0,0,0,0,-2/e,0,0,0,0,1,0,-1,1,0,1];var r=this.context.getUniformLocation(this.shaderProgram,"uProjection");this.context.uniformMatrix4fv(r,!1,new Float32Array(this.projectionMatrix))}},{key:"loadShader",value:function(t,e){var r=this.context.createShader(t);return this.context.shaderSource(r,e),this.context.compileShader(r),this.context.getShaderParameter(r,this.context.COMPILE_STATUS)?r:(console.error("Ошибка при компиляции шейдера:",this.context.getShaderInfoLog(r)),this.context.deleteShader(r),null)}},{key:"clear",value:function(){this.context.clear(this.context.COLOR_BUFFER_BIT|this.context.DEPTH_BUFFER_BIT)}},{key:"render",value:function(t){var e=this;this.clear(),t&&t.gameObjects?t.gameObjects.forEach((function(t){e.drawEntity(t)})):console.error("No game objects found in the scene!")}},{key:"drawEntity",value:function(t){t&&"function"==typeof t.renderWebGL?t.renderWebGL(this.context,this.shaderProgram):console.error("Object does not have a renderWebGL method!")}}])&&b(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(i);function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function O(){O=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},u=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof d?e:d,u=Object.create(i.prototype),a=new C(n||[]);return o(u,"_invoke",{value:E(t,r,a)}),u}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var y="suspendedStart",h="suspendedYield",p="executing",b="completed",v={};function d(){}function m(){}function g(){}var w={};f(w,u,(function(){return this}));var P=Object.getPrototypeOf,A=P&&P(P(k([])));A&&A!==r&&n.call(A,u)&&(w=A);var j=g.prototype=d.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,u,a){var c=s(t[o],t,i);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==x(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,u,a)}),(function(t){r("throw",t,u,a)})):e.resolve(l).then((function(t){f.value=t,u(f)}),(function(t){return r("throw",t,u,a)}))}a(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function E(e,r,n){var o=y;return function(i,u){if(o===p)throw Error("Generator is already running");if(o===b){if("throw"===i)throw u;return{value:t,done:!0}}for(n.method=i,n.arg=u;;){var a=n.delegate;if(a){var c=_(a,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=b,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var f=s(e,r,n);if("normal"===f.type){if(o=n.done?b:h,f.arg===v)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(o=b,n.method="throw",n.arg=f.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=s(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var u=i.arg;return u?u.done?(r[e.resultName]=u.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):u:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function B(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function k(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(x(e)+" is not iterable")}return m.prototype=g,o(j,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=f(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,f(t,c,"GeneratorFunction")),t.prototype=Object.create(j),t},e.awrap=function(t){return{__await:t}},S(T.prototype),f(T.prototype,a,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var u=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},S(j),f(j,c,"Generator"),f(j,u,(function(){return this})),f(j,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=k,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(B),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var u=this.tryEntries[i],a=u.completion;if("root"===u.tryLoc)return o("end");if(u.tryLoc<=this.prev){var c=n.call(u,"catchLoc"),f=n.call(u,"finallyLoc");if(c&&f){if(this.prev<u.catchLoc)return o(u.catchLoc,!0);if(this.prev<u.finallyLoc)return o(u.finallyLoc)}else if(c){if(this.prev<u.catchLoc)return o(u.catchLoc,!0)}else{if(!f)throw Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return o(u.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var u=i?i.completion:{};return u.type=t,u.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(u)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),B(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;B(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:k(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function P(t,e,r,n,o,i,u){try{var a=t[i](u),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,o)}function A(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function u(t){P(i,n,o,u,a,"next",t)}function a(t){P(i,n,o,u,a,"throw",t)}u(void 0)}))}}function j(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,S(n.key),n)}}function S(t){var e=function(t){if("object"!=x(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==x(e)?e:e+""}function T(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(T=function(){return!!t})()}function E(t){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},E(t)}function _(t,e){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_(t,e)}var R=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,r){return e=E(e),function(t,e){if(e&&("object"==x(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,T()?Reflect.construct(e,r||[],E(t).constructor):e.apply(t,r))}(this,e,[t])).device=null,n.context=null,n.renderPassDescriptor=null,n.pipeline=null,n.isInitialized=!1,n.backgroundColor=r||[0,0,0,1],n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_(t,e)}(e,t),r=e,n=[{key:"init",value:(u=A(O().mark((function t(){return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initializeWebGPU();case 2:this.isInitialized=!0;case 3:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"initializeWebGPU",value:(i=A(O().mark((function t(){var e,r;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(navigator.gpu){t.next=3;break}return console.error("WebGPU не поддерживается в этом браузере."),t.abrupt("return");case 3:return t.next=5,navigator.gpu.requestAdapter();case 5:if(e=t.sent){t.next=9;break}return console.error("Не удалось получить адаптер GPU."),t.abrupt("return");case 9:return t.next=11,e.requestDevice();case 11:if(this.device=t.sent,this.context=this.canvas.getContext("webgpu"),this.context){t.next=16;break}return console.error("Не удалось получить WebGPU контекст из canvas."),t.abrupt("return");case 16:return r=navigator.gpu.getPreferredCanvasFormat(),this.context.configure({device:this.device,format:r,alphaMode:"opaque"}),this.renderPassDescriptor={colorAttachments:[{view:void 0,clearValue:{r:this.backgroundColor[0],g:this.backgroundColor[1],b:this.backgroundColor[2],a:this.backgroundColor[3]},loadOp:"clear",storeOp:"store"}]},t.next=21,this.initPipeline(r);case 21:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"initPipeline",value:(o=A(O().mark((function t(e){var r,n,o;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=this.device.createShaderModule({code:"\n      @group(0) @binding(0)\n      var<uniform> uProjection : mat4x4<f32>;\n\n      @group(0) @binding(1)\n      var<uniform> uTransform : mat4x4<f32>;\n\n      struct VertexOutput {\n        @builtin(position) Position : vec4<f32>,\n        @location(0) vColor : vec4<f32>,\n      };\n\n      @vertex\n      fn main(\n        @location(0) aPosition : vec2<f32>,\n        @location(1) aColor : vec4<f32>\n      ) -> VertexOutput {\n        var output : VertexOutput;\n        var position : vec4<f32> = vec4<f32>(aPosition, 0.0, 1.0);\n        output.Position = uProjection * uTransform * position;\n        output.vColor = aColor;\n        return output;\n      }\n    "}),n=this.device.createShaderModule({code:"\n      @fragment\n      fn main(@location(0) vColor : vec4<f32>) -> @location(0) vec4<f32> {\n        return vColor;\n      }\n    "}),this.bindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}}]}),o=this.device.createPipelineLayout({bindGroupLayouts:[this.bindGroupLayout]}),this.pipeline=this.device.createRenderPipeline({layout:o,vertex:{module:r,entryPoint:"main",buffers:[{arrayStride:8,attributes:[{shaderLocation:0,offset:0,format:"float32x2"}]},{arrayStride:16,attributes:[{shaderLocation:1,offset:0,format:"float32x4"}]}]},fragment:{module:n,entryPoint:"main",targets:[{format:e}]},primitive:{topology:"triangle-list",stripIndexFormat:void 0,frontFace:"ccw",cullMode:"none"}}),this.createProjectionMatrix();case 8:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"createProjectionMatrix",value:function(){var t=this.canvas.width,e=this.canvas.height;this.projectionMatrix=new Float32Array([2/t,0,0,0,0,-2/e,0,0,0,0,1,0,-1,1,0,1]),this.projectionBuffer=this.device.createBuffer({size:this.projectionMatrix.byteLength,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.device.queue.writeBuffer(this.projectionBuffer,0,this.projectionMatrix)}},{key:"render",value:function(t){var e=this;if(this.isInitialized)if(this.device&&this.context){var r=this.context.getCurrentTexture().createView();this.renderPassDescriptor.colorAttachments[0].view=r;var n=this.device.createCommandEncoder(),o=n.beginRenderPass(this.renderPassDescriptor);o.setPipeline(this.pipeline),this.bindGroupProjection=this.device.createBindGroup({layout:this.bindGroupLayout,entries:[{binding:0,resource:{buffer:this.projectionBuffer}},{binding:1,resource:{buffer:this.projectionBuffer}}]}),t&&t.gameObjects?t.gameObjects.forEach((function(t){e.drawEntity(t,o)})):console.error("No game objects found in the scene!"),o.end();var i=n.finish();this.device.queue.submit([i])}else console.error("WebGPU устройство или контекст не инициализированы.");else console.warn("WebGPURenderer еще не инициализирован.")}},{key:"drawEntity",value:function(t,e){t&&"function"==typeof t.renderWebGPU?t.renderWebGPU(this.device,e,this.bindGroupLayout,this.projectionBuffer):console.error("Object does not have a renderWebGPU method!")}}],n&&j(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i,u}(i);function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function C(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,k(n.key),n)}}function k(t){var e=function(t){if("object"!=B(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==B(e)?e:e+""}var F=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"canvas",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"2d",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"black",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:900,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=document.getElementById(e),!this.canvas)throw new Error("Canvas with id ".concat(e," not found!"));this.canvas.width=o,this.canvas.height=i,this.context=this.initializeContext(r),this.renderer=this.createRenderer(r,n)},(e=[{key:"initializeContext",value:function(t){if("2d"===t)return this.canvas.getContext("2d");if("webgl"===t)return this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl");if("webgpu"===t){if(navigator.gpu)return this.canvas.getContext("webgpu");throw new Error("WebGPU not supported on this browser.")}throw new Error("Unsupported context type: "+t)}},{key:"createRenderer",value:function(t,e){if("2d"===t)return new y(this,e);if("webgl"===t)return new w(this,e);if("webgpu"===t)return new R(this,e);throw new Error("Unsupported render type: "+t)}},{key:"getContext",value:function(){return this.context}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getRenderer",value:function(){return this.renderer}}])&&C(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function U(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,M(n.key),n)}}function M(t){var e=function(t){if("object"!=L(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==L(e)?e:e+""}var I=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9.8;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gravity=e},(e=[{key:"updatePhysics",value:function(t,e){var r=this;t.forEach((function(t){t.rigidBody&&(r.applyGravity(t,e),r.applyMovement(t,e))})),t.forEach((function(e){if(e.rigidBody){var n=t.filter((function(t){return t!==e&&t.rigidBody}));r.checkCollisions(e,n)}}))}},{key:"applyGravity",value:function(t,e){var r=t.rigidBody;if(r&&!r.isStatic){var n=e/1e3;r.velocityY+=this.gravity*n*100}}},{key:"applyMovement",value:function(t,e){var r=t.rigidBody;if(r&&!r.isStatic){var n=e/1e3;r.velocityX*=r.friction,r.velocityY*=r.friction,r.x+=r.velocityX*n,r.y+=r.velocityY*n,t.x=r.x,t.y=r.y}}},{key:"checkCollisions",value:function(t,e){var r=this;e.forEach((function(e){e.rigidBody&&r.isColliding(t,e)&&r.resolveCollision(t,e)}))}},{key:"isColliding",value:function(t,e){var r=t.rigidBody,n=e.rigidBody;return r.x<n.x+n.width&&r.x+r.width>n.x&&r.y<n.y+n.height&&r.y+r.height>n.y}},{key:"resolveCollision",value:function(t,e){var r=t.rigidBody,n=e.rigidBody;n.isStatic&&r.velocityY>0&&(r.y=n.y-r.height,r.velocityY=0,r.onGround=!0),t.x=r.x,t.y=r.y}}])&&U(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function Y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,W(n.key),n)}}function W(t){var e=function(t){if("object"!=D(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==D(e)?e:e+""}var G=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.core=e,this.sceneManager=e.sceneManager,this.physicsEngine=new I},(e=[{key:"start",value:function(){}},{key:"update",value:function(t){var e=this.sceneManager.getCurrentScene();e&&(this.physicsEngine.updatePhysics(e.gameObjects,t),this.handleGameTypeSpecificLogic(t))}},{key:"handleGameTypeSpecificLogic",value:function(t){}}])&&Y(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function V(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,z(n.key),n)}}function N(t,e,r){return e&&V(t.prototype,e),r&&V(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function z(t){var e=function(t){if("object"!=X(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=X(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==X(e)?e:e+""}var q=N((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.mass,n=void 0===r?1:r,o=e.friction,i=void 0===o?.9:o,u=e.isStatic,a=void 0!==u&&u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mass=n,this.friction=i,this.isStatic=a,this.velocityX=0,this.velocityY=0,this.onGround=!1,this.x=0,this.y=0,this.width=0,this.height=0}));function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function K(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,H(n.key),n)}}function H(t){var e=function(t){if("object"!=$(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$(e)?e:e+""}var Q=function(){return t=function t(e){var r=e.x,n=e.y,o=e.width,i=e.height,u=e.color,a=e.sprite,c=e.animations,f=void 0===c?{}:c,l=e.health,s=void 0===l?100:l,y=e.speed,h=void 0===y?30:y,p=e.enablePhysics,b=void 0!==p&&p,v=e.layer,d=void 0===v?1:v;for(var m in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=r,this.y=n,this.width=o,this.height=i,this.color=u,this.health=s,this.speed=h,this.currentFrameIndex=0,this.frameDuration=100,this.elapsedTime=0,this.facingDirection=1,this.layer=d,this.sprite=a?new Image:null,this.sprite&&(this.sprite.src=a),this.animations={idle:f.idle||[],run:f.run||[],jump:f.jump||[],attack:f.attack||[]},0===this.animations.idle.length&&(this.animations.idle=this.animations.run),this.currentAnimation=this.sprite?null:"idle",this.animations)this.animations[m].length>0&&(this.animations[m]=this.animations[m].map((function(t){var e=new Image;return e.src=t,e})));b?(this.rigidBody=new q({mass:1,friction:.9,isStatic:!1}),this.rigidBody.x=this.x,this.rigidBody.y=this.y,this.rigidBody.width=this.width,this.rigidBody.height=this.height):this.rigidBody=null},(e=[{key:"setAnimation",value:function(t){this.animations[t]&&this.animations[t].length>0&&this.currentAnimation!==t&&(this.currentAnimation=t,this.currentFrameIndex=0,this.elapsedTime=0)}},{key:"update",value:function(t){this.rigidBody&&(this.x=this.rigidBody.x,this.y=this.rigidBody.y,this.rigidBody.velocityX>0?this.facingDirection=1:this.rigidBody.velocityX<0&&(this.facingDirection=-1),this.rigidBody.onGround?0!==this.rigidBody.velocityX?this.setAnimation("run"):this.setAnimation("idle"):this.setAnimation("jump"));var e=this.currentAnimation?this.animations[this.currentAnimation]:[];e.length>0&&(this.elapsedTime+=t,this.elapsedTime>=this.frameDuration&&(this.elapsedTime=0,this.currentFrameIndex=(this.currentFrameIndex+1)%e.length))}},{key:"render",value:function(t){if(t.save(),-1===this.facingDirection?(t.translate(this.x+this.width/2,this.y),t.scale(-1,1),t.translate(-this.width/2,0)):t.translate(this.x,this.y),this.sprite&&this.sprite.complete)t.drawImage(this.sprite,0,0,this.width,this.height);else{var e=this.currentAnimation?this.animations[this.currentAnimation]:[];e.length>0&&e[this.currentFrameIndex].complete?t.drawImage(e[this.currentFrameIndex],0,0,this.width,this.height):(t.fillStyle=this.color,t.fillRect(0,0,this.width,this.height))}t.restore()}},{key:"takeDamage",value:function(t){this.health-=t,this.health<=0&&this.die()}},{key:"die",value:function(){console.log("Character died")}}])&&K(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}function Z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function tt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(r),!0).forEach((function(e){et(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function et(t,e,r){return(e=nt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nt(n.key),n)}}function nt(t){var e=function(t){if("object"!=J(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=J(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==J(e)?e:e+""}function ot(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ot=function(){return!!t})()}function it(t,e,r,n){var o=ut(at(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function ut(){return ut="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=at(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ut.apply(null,arguments)}function at(t){return at=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},at(t)}function ct(t,e){return ct=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ct(t,e)}var ft=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,r){return e=at(e),function(t,e){if(e&&("object"==J(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ot()?Reflect.construct(e,r||[],at(t).constructor):e.apply(t,r))}(this,e,[tt(tt({},t),{},{health:100,magic:100,shots:10,score:0})])).magic=t.magic||100,r.shots=t.shots||10,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ct(t,e)}(e,t),r=e,(n=[{key:"update",value:function(t){it(e,"update",this,3)([t])}},{key:"render",value:function(t){it(e,"render",this,3)([t])}},{key:"shoot",value:function(){this.shots>0?(this.shots-=1,console.log("Выстрел произведен!")):console.log("Нет патронов!")}},{key:"useMagic",value:function(t){this.magic>=t?(this.magic-=t,console.log("Использована магия")):console.log("Недостаточно магии")}}])&&rt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Q);function lt(t){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lt(t)}function st(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yt(n.key),n)}}function yt(t){var e=function(t){if("object"!=lt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==lt(e)?e:e+""}var ht=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.keysPressed={},this.initEventListeners()},e=[{key:"initEventListeners",value:function(){var t=this;window.addEventListener("keydown",(function(e){t.keysPressed[e.key]=!0})),window.addEventListener("keyup",(function(e){t.keysPressed[e.key]=!1}))}},{key:"isKeyPressed",value:function(t){return this.keysPressed[t]||!1}}],e&&st(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function bt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function vt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?bt(Object(r),!0).forEach((function(e){dt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function dt(t,e,r){return(e=gt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gt(n.key),n)}}function gt(t){var e=function(t){if("object"!=pt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pt(e)?e:e+""}function wt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(wt=function(){return!!t})()}function xt(t,e,r,n){var o=Ot(Pt(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function Ot(){return Ot="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Pt(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Ot.apply(null,arguments)}function Pt(t){return Pt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pt(t)}function At(t,e){return At=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},At(t,e)}var jt=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Pt(e),function(t,e){if(e&&("object"==pt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,wt()?Reflect.construct(e,r||[],Pt(t).constructor):e.apply(t,r))}(this,e,[vt(vt({},t),{},{health:50,speed:20})])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&At(t,e)}(e,t),r=e,(n=[{key:"update",value:function(t){xt(e,"update",this,3)([t]),this.patrol()}},{key:"patrol",value:function(){this.x<=this.leftBoundary?(this.rigidBody.velocityX=this.speed,this.facingDirection=1):this.x+this.width>=this.rightBoundary&&(this.rigidBody.velocityX=-this.speed,this.facingDirection=-1)}},{key:"render",value:function(t){xt(e,"render",this,3)([t])}}])&&mt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Q);function St(t){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},St(t)}function Tt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Et(n.key),n)}}function Et(t){var e=function(t){if("object"!=St(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=St(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==St(e)?e:e+""}function _t(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_t=function(){return!!t})()}function Rt(t){return Rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Rt(t)}function Bt(t,e){return Bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Bt(t,e)}var Ct=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,r){return e=Rt(e),function(t,e){if(e&&("object"==St(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,_t()?Reflect.construct(e,r||[],Rt(t).constructor):e.apply(t,r))}(this,e,[t])).player=r.getPlayerFromCurrentScene(),r.keyboardControl=new ht,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bt(t,e)}(e,t),r=e,(n=[{key:"getPlayerFromCurrentScene",value:function(){var t=this.sceneManager.getCurrentScene();return t?t.gameObjects.find((function(t){return t instanceof ft})):(console.error("No current scene found."),null)}},{key:"handleGameTypeSpecificLogic",value:function(t){this.player&&this.player.rigidBody&&this.handleInput(t)}},{key:"handleInput",value:function(t){var e=this.player.rigidBody,r=t/1e3,n=6e3*this.player.speed*r;this.keyboardControl.isKeyPressed("ArrowLeft")?e.velocityX=-n:this.keyboardControl.isKeyPressed("ArrowRight")?e.velocityX=n:e.velocityX=0,this.keyboardControl.isKeyPressed(" ")&&e.onGround&&(e.velocityY=-1200,e.onGround=!1)}},{key:"checkPlayerEnemyCollisions",value:function(){var t=this;this.sceneManager.getCurrentScene().gameObjects.filter((function(t){return t instanceof jt})).forEach((function(e){t.isColliding(t.player,e)&&t.resolvePlayerEnemyCollision(t.player,e)}))}},{key:"resolvePlayerEnemyCollision",value:function(t,e){var r=this;t.rigidBody.velocityY>0&&t.y+t.height<=e.y+e.height/2?(e.setAnimation("die"),setTimeout((function(){var t=r.sceneManager.getCurrentScene();r.sceneManager.removeGameObjectFromScene(t.name,e)}),e.frameDuration*e.animations.die.length),this.score+=100,t.rigidBody.velocityY=-600):(t.health-=1,t.health<=0&&console.log("Игрок погиб!"))}}])&&Tt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(G);function kt(t){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kt(t)}function Ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lt(n.key),n)}}function Lt(t){var e=function(t){if("object"!=kt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=kt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==kt(e)?e:e+""}var Ut=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.core=e},(e=[{key:"loadGameType",value:function(t){return console.log("Загрузка типа игры: ".concat(t)),"platformer"===t?(console.log(this.core),console.log("Создание экземпляра PlatformerGameType для: ".concat(t)),new Ct(this.core)):(console.warn("Неизвестный тип игры: ".concat(t)),null)}}])&&Ft(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Mt(t,e){if("2d"===e){if("string"==typeof t)return t in It?It[t]:t;throw new Error("Unsupported color format for Canvas: "+t)}if("webgl"===e||"webgpu"===e){if("string"==typeof t&&t.startsWith("rgb("))return t.match(/\d+/g).map(Number).map((function(t){return t/255}));if("string"==typeof t&&(t in It&&(t=It[t]),"#"===t[0]))return function(t){4===t.length&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]);var e=parseInt(t.slice(1),16);return[(e>>16&255)/255,(e>>8&255)/255,(255&e)/255]}(t);if(Array.isArray(t))return t.map((function(t){return t/255}));throw new Error("Unsupported color format for WebGL/WebGPU: "+t)}throw new Error("Unsupported render type: "+e)}var It={black:"#000000",white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",gray:"#808080",yellow:"#FFFF00"};function Dt(t){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(t)}function Yt(){Yt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},u=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof d?e:d,u=Object.create(i.prototype),a=new R(n||[]);return o(u,"_invoke",{value:S(t,r,a)}),u}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var y="suspendedStart",h="suspendedYield",p="executing",b="completed",v={};function d(){}function m(){}function g(){}var w={};f(w,u,(function(){return this}));var x=Object.getPrototypeOf,O=x&&x(x(B([])));O&&O!==r&&n.call(O,u)&&(w=O);var P=g.prototype=d.prototype=Object.create(w);function A(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,i,u,a){var c=s(t[o],t,i);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==Dt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,u,a)}),(function(t){r("throw",t,u,a)})):e.resolve(l).then((function(t){f.value=t,u(f)}),(function(t){return r("throw",t,u,a)}))}a(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=y;return function(i,u){if(o===p)throw Error("Generator is already running");if(o===b){if("throw"===i)throw u;return{value:t,done:!0}}for(n.method=i,n.arg=u;;){var a=n.delegate;if(a){var c=T(a,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=b,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var f=s(e,r,n);if("normal"===f.type){if(o=n.done?b:h,f.arg===v)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(o=b,n.method="throw",n.arg=f.arg)}}}function T(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=s(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var u=i.arg;return u?u.done?(r[e.resultName]=u.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):u:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function B(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Dt(e)+" is not iterable")}return m.prototype=g,o(P,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=f(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,f(t,c,"GeneratorFunction")),t.prototype=Object.create(P),t},e.awrap=function(t){return{__await:t}},A(j.prototype),f(j.prototype,a,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var u=new j(l(t,r,n,o),i);return e.isGeneratorFunction(r)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},A(P),f(P,c,"Generator"),f(P,u,(function(){return this})),f(P,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=B,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var u=this.tryEntries[i],a=u.completion;if("root"===u.tryLoc)return o("end");if(u.tryLoc<=this.prev){var c=n.call(u,"catchLoc"),f=n.call(u,"finallyLoc");if(c&&f){if(this.prev<u.catchLoc)return o(u.catchLoc,!0);if(this.prev<u.finallyLoc)return o(u.finallyLoc)}else if(c){if(this.prev<u.catchLoc)return o(u.catchLoc,!0)}else{if(!f)throw Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return o(u.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var u=i?i.completion:{};return u.type=t,u.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(u)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:B(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Wt(t,e,r,n,o,i,u){try{var a=t[i](u),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,o)}function Gt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xt(n.key),n)}}function Xt(t){var e=function(t){if("object"!=Dt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Dt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Dt(e)?e:e+""}var Vt=function(){return t=function t(e){var r=e.canvasId,n=e.renderType,o=void 0===n?"2d":n,i=e.backgroundColor,u=void 0===i?"black":i,a=e.sceneManager,c=e.width,f=void 0===c?900:c,l=e.height,s=void 0===l?600:l;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var y=Mt(u,o);this.graphicalContext=new F(r,o,y,f,s),this.renderer=this.graphicalContext.getRenderer(),this.sceneManager=a,this.lastTime=0,this.loop=this.loop.bind(this),this.gameTypeInstance=null},e=[{key:"setGameType",value:function(t){t&&(console.log("Установка типа игры: ".concat(t)),this.gameTypeInstance=new Ut(this).loadGameType(t),this.gameTypeInstance||console.error("Ошибка: тип игры ".concat(t," не загружен.")))}},{key:"start",value:(r=Yt().mark((function t(){return Yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("function"!=typeof this.renderer.init){t.next=3;break}return t.next=3,this.renderer.init();case 3:this.gameTypeInstance&&"function"==typeof this.gameTypeInstance.start&&this.gameTypeInstance.start(),requestAnimationFrame(this.loop);case 5:case"end":return t.stop()}}),t,this)})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function u(t){Wt(i,n,o,u,a,"next",t)}function a(t){Wt(i,n,o,u,a,"throw",t)}u(void 0)}))},function(){return n.apply(this,arguments)})},{key:"loop",value:function(t){var e=t-this.lastTime;this.lastTime=t,this.gameTypeInstance&&this.gameTypeInstance.update&&this.gameTypeInstance.update(e),this.sceneManager.update(e),this.renderer.clear(),this.sceneManager.render(this.renderer.context),requestAnimationFrame(this.loop)}}],e&&Gt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Nt(t){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nt(t)}function zt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qt(n.key),n)}}function qt(t){var e=function(t){if("object"!=Nt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Nt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Nt(e)?e:e+""}var $t=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scenes={},this.currentScene=null},e=[{key:"createScene",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];r.forEach((function(e){t.scenes[e]?console.warn('Сцена "'.concat(e,'" уже существует.')):(t.scenes[e]={name:e,gameObjects:[]},console.log('Сцена "'.concat(e,'" создана.')))}))}},{key:"changeScene",value:function(t){this.scenes[t]?(this.currentScene=this.scenes[t],console.log('Переключено на сцену "'.concat(t,'".'))):console.error('Сцена "'.concat(t,'" не существует.'))}},{key:"addGameObjectToScene",value:function(t){var e=this.scenes[t];if(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];n.forEach((function(r){e.gameObjects.includes(r)?console.warn('Объект уже добавлен в сцену "'.concat(t,'".')):e.gameObjects.push(r)}))}else console.error('Невозможно добавить объект в несуществующую сцену: "'.concat(t,'".'))}},{key:"update",value:function(t){this.currentScene&&this.currentScene.gameObjects.forEach((function(e){"function"==typeof e.update&&e.update(t)}))}},{key:"render",value:function(t){this.currentScene&&this.currentScene.gameObjects.sort((function(t,e){return t.layer-e.layer})).forEach((function(e){"function"==typeof e.render&&e.render(t)}))}},{key:"getCurrentScene",value:function(){return this.currentScene}},{key:"removeGameObjectFromScene",value:function(t,e){var r=this.scenes[t];if(r){var n=r.gameObjects.indexOf(e);-1!==n?(r.gameObjects.splice(n,1),console.log('Объект удален из сцены "'.concat(t,'".'))):console.warn('Объект не найден в сцене "'.concat(t,'".'))}else console.error('Сцена "'.concat(t,'" не существует.'))}},{key:"getGameObjectsFromCurrentScene",value:function(){return this.currentScene?this.currentScene.gameObjects:[]}},{key:"getGameObjectsByType",value:function(t){return this.currentScene?this.currentScene.gameObjects.filter((function(e){return e instanceof t})):(console.error("Текущая сцена не установлена."),[])}},{key:"getGameObjectById",value:function(t){return this.currentScene?this.currentScene.gameObjects.find((function(e){return e.id===t}))||null:(console.error("Текущая сцена не установлена."),null)}},{key:"clearScene",value:function(t){this.scenes[t]?(this.scenes[t].gameObjects=[],console.log('Сцена "'.concat(t,'" очищена.'))):console.error('Сцена "'.concat(t,'" не существует.'))}},{key:"changeToNextScene",value:function(){var t,e=Object.keys(this.scenes),r=e.indexOf(null===(t=this.currentScene)||void 0===t?void 0:t.name);-1!==r&&r<e.length-1?this.changeScene(e[r+1]):console.warn("Следующая сцена не найдена или вы находитесь в последней сцене.")}}],e&&zt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Kt(t){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kt(t)}function Ht(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qt(n.key),n)}}function Qt(t){var e=function(t){if("object"!=Kt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Kt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Kt(e)?e:e+""}var Jt=function(){return t=function t(e){var r=e.x,n=e.y,o=e.width,i=e.height,u=e.color,a=e.enablePhysics,c=void 0!==a&&a,f=e.isStatic,l=void 0!==f&&f,s=e.layer,y=void 0===s?0:s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=r,this.y=n,this.width=o,this.height=i,this.color=u,this.layer=y,c?(this.rigidBody=new q({isStatic:l}),this.rigidBody.x=this.x,this.rigidBody.y=this.y,this.rigidBody.width=this.width,this.rigidBody.height=this.height):this.rigidBody=null},(e=[{key:"update",value:function(t){this.rigidBody?(this.x=this.rigidBody.x,this.y=this.rigidBody.y):(this.x+=this.speedX*t/1e3,this.y+=this.speedY*t/1e3)}},{key:"render",value:function(t){}}])&&Ht(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Zt(t){return Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zt(t)}function te(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ee(n.key),n)}}function ee(t){var e=function(t){if("object"!=Zt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Zt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Zt(e)?e:e+""}function re(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(re=function(){return!!t})()}function ne(t){return ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ne(t)}function oe(t,e){return oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},oe(t,e)}var ie=function(t){function e(t,r,n){var o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n,u=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=function(t,e,r){return e=ne(e),function(t,e){if(e&&("object"==Zt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,re()?Reflect.construct(e,r||[],ne(t).constructor):e.apply(t,r))}(this,e,[t,r,n,i,u])).borderColor=a,o.borderWidth=c,o.round=f,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oe(t,e)}(e,t),r=e,(n=[{key:"render",value:function(t){t.beginPath(),this.round>0?this.roundedRect(t,this.x,this.y,this.width,this.height,this.round):t.rect(this.x,this.y,this.width,this.height),t.fillStyle=this.color,t.fill(),this.borderColor&&(t.strokeStyle=this.borderColor,t.lineWidth=this.borderWidth,t.stroke()),t.closePath()}},{key:"roundedRect",value:function(t,e,r,n,o,i){t.moveTo(e+i,r),t.arcTo(e+n,r,e+n,r+o,i),t.arcTo(e+n,r+o,e,r+o,i),t.arcTo(e,r+o,e,r,i),t.arcTo(e,r,e+n,r,i)}}])&&te(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function ue(t){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(t)}function ae(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ce(n.key),n)}}function ce(t){var e=function(t){if("object"!=ue(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ue(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ue(e)?e:e+""}function fe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(fe=function(){return!!t})()}function le(t){return le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},le(t)}function se(t,e){return se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},se(t,e)}var ye=function(t){function e(t,r,n){var o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"black",c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=function(t,e,r){return e=le(e),function(t,e){if(e&&("object"==ue(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,fe()?Reflect.construct(e,r||[],le(t).constructor):e.apply(t,r))}(this,e,[t,r,2*n,2*n,a])).radius=n,o.startAngle=i,o.endAngle=u,o.borderColor=c,o.borderWidth=f,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&se(t,e)}(e,t),r=e,(n=[{key:"render",value:function(t){t.beginPath(),t.arc(this.x+this.radius,this.y+this.radius,this.radius,this.startAngle,this.endAngle),t.fillStyle=this.color,t.fill(),this.borderColor&&(t.strokeStyle=this.borderColor,t.lineWidth=this.borderWidth,t.stroke()),t.closePath()}}])&&ae(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function he(t){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},he(t)}function pe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,be(n.key),n)}}function be(t){var e=function(t){if("object"!=he(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=he(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==he(e)?e:e+""}function ve(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ve=function(){return!!t})()}function de(t){return de=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},de(t)}function me(t,e){return me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},me(t,e)}var ge=function(t){function e(t,r,n,o,i,u,a,c){var f,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(f=function(t,e,r){return e=de(e),function(t,e){if(e&&("object"==he(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ve()?Reflect.construct(e,r||[],de(t).constructor):e.apply(t,r))}(this,e,[t,r,2*n,2*o,c])).rX=n,f.rY=o,f.rot=i,f.start=u,f.end=a,f.borderColor=l,f.borderWidth=s,f}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&me(t,e)}(e,t),r=e,(n=[{key:"render",value:function(t){t.beginPath(),t.ellipse(this.x,this.y,this.rX,this.rY,this.rot,this.start,this.end*Math.PI),t.fillStyle=this.color,t.fill(),this.borderColor&&(t.strokeStyle=this.borderColor,t.lineWidth=this.borderWidth,t.stroke()),t.closePath()}}])&&pe(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function we(t){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},we(t)}function xe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Oe(n.key),n)}}function Oe(t){var e=function(t){if("object"!=we(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=we(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==we(e)?e:e+""}function Pe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Pe=function(){return!!t})()}function Ae(t){return Ae=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ae(t)}function je(t,e){return je=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},je(t,e)}var Se=function(t){function e(t,r,n){var o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"black",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"Arial",c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=function(t,e,r){return e=Ae(e),function(t,e){if(e&&("object"==we(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Pe()?Reflect.construct(e,r||[],Ae(t).constructor):e.apply(t,r))}(this,e,[r,n,0,0,u])).text=t,o.fontsize=i,o.fontFamily=a,o.borderColor=c,o.borderWidth=f,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&je(t,e)}(e,t),r=e,(n=[{key:"render",value:function(t){t.beginPath(),t.font="".concat(this.fontsize,"px ").concat(this.fontFamily),t.fillStyle=this.color,t.fillText(this.text,this.x,this.y),this.borderColor&&this.borderWidth>0&&(t.strokeStyle=this.borderColor,t.lineWidth=this.borderWidth,t.strokeText(this.text,this.x,this.y)),t.closePath()}}])&&xe(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function Te(t){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Te(t)}function Ee(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_e(n.key),n)}}function _e(t){var e=function(t){if("object"!=Te(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Te(e)?e:e+""}function Re(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Re=function(){return!!t})()}function Be(t){return Be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Be(t)}function Ce(t,e){return Ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ce(t,e)}var ke=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,r){return e=Be(e),function(t,e){if(e&&("object"==Te(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Re()?Reflect.construct(e,r||[],Be(t).constructor):e.apply(t,r))}(this,e,[{x:t.x,y:t.y,width:t.width,height:t.height,color:null,enablePhysics:t.enablePhysics||!1,isStatic:t.isStatic||!1,layer:t.layer||0}])).image=t.image,r.preserveAspectRatio=t.preserveAspectRatio||!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ce(t,e)}(e,t),r=e,(n=[{key:"update",value:function(t){this.rigidBody&&(this.x=this.rigidBody.x,this.y=this.rigidBody.y)}},{key:"render",value:function(t){if(this.image.complete){var e=this.width,r=this.height;if(this.preserveAspectRatio){var n=this.image.width/this.image.height;this.width/this.height>n?e=this.height*n:r=this.width/n}t.drawImage(this.image,this.x,this.y,e,r)}}}])&&Ee(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function Fe(t){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fe(t)}function Le(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ue(n.key),n)}}function Ue(t){var e=function(t){if("object"!=Fe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Fe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Fe(e)?e:e+""}function Me(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Me=function(){return!!t})()}function Ie(t){return Ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ie(t)}function De(t,e){return De=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},De(t,e)}var Ye=function(t){function e(t,r,n,o){var i,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"black",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"butt";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e,r){return e=Ie(e),function(t,e){if(e&&("object"==Fe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Me()?Reflect.construct(e,r||[],Ie(t).constructor):e.apply(t,r))}(this,e,[t,r,n-t,o-r,u])).x1=t,i.y1=r,i.x2=n,i.y2=o,i.color=u,i.widthline=a,i.lineRounded=c,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&De(t,e)}(e,t),r=e,(n=[{key:"render",value:function(t){t.beginPath(),t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2),t.strokeStyle=this.color,t.lineWidth=this.widthline,t.lineCap=this.lineRounded,t.stroke(),t.closePath()}}])&&Le(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function We(t){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},We(t)}function Ge(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xe(n.key),n)}}function Xe(t){var e=function(t){if("object"!=We(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=We(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==We(e)?e:e+""}function Ve(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ve=function(){return!!t})()}function Ne(t){return Ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ne(t)}function ze(t,e){return ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ze(t,e)}var qe=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"black",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,r){return e=Ne(e),function(t,e){if(e&&("object"==We(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ve()?Reflect.construct(e,r||[],Ne(t).constructor):e.apply(t,r))}(this,e,[t[0].x,t[0].y,0,0,n])).vertices=t,r.color=n,r.borderColor=o,r.borderWidth=i,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ze(t,e)}(e,t),r=e,(n=[{key:"render",value:function(t){t.beginPath(),t.moveTo(this.vertices[0].x,this.vertices[0].y);for(var e=1;e<this.vertices.length;e++)t.lineTo(this.vertices[e].x,this.vertices[e].y);t.closePath(),t.fillStyle=this.color,t.fill(),this.borderColor&&(t.strokeStyle=this.borderColor,t.lineWidth=this.borderWidth,t.stroke())}}])&&Ge(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function $e(t){return $e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$e(t)}function Ke(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,He(n.key),n)}}function He(t){var e=function(t){if("object"!=$e(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$e(e)?e:e+""}function Qe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Qe=function(){return!!t})()}function Je(t){return Je=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Je(t)}function Ze(t,e){return Ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ze(t,e)}var tr=function(t){function e(t,r,n,o,i,u,a,c){var f,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"black",s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(f=function(t,e,r){return e=Je(e),function(t,e){if(e&&("object"==$e(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Qe()?Reflect.construct(e,r||[],Je(t).constructor):e.apply(t,r))}(this,e,[t,r,0,0,l])).startX=t,f.startY=r,f.controlX1=n,f.controlY1=o,f.controlX2=i,f.controlY2=u,f.endX=a,f.endY=c,f.color=l,f.widthline=s,f}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ze(t,e)}(e,t),r=e,(n=[{key:"render",value:function(t){t.beginPath(),t.moveTo(this.startX,this.startY),t.bezierCurveTo(this.controlX1,this.controlY1,this.controlX2,this.controlY2,this.endX,this.endY),t.strokeStyle=this.color,t.lineWidth=this.widthline,t.stroke(),t.closePath()}}])&&Ke(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function er(t){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},er(t)}function rr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nr(n.key),n)}}function nr(t){var e=function(t){if("object"!=er(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=er(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==er(e)?e:e+""}function or(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(or=function(){return!!t})()}function ir(t){return ir=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ir(t)}function ur(t,e){return ur=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ur(t,e)}var ar=function(t){function e(t,r,n,o){var i,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"black",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e,r){return e=ir(e),function(t,e){if(e&&("object"==er(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,or()?Reflect.construct(e,r||[],ir(t).constructor):e.apply(t,r))}(this,e,[t,r,2*n,2*n,u])).radius=n,i.points=o,i.color=u,i.borderColor=a,i.borderWidth=c,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ur(t,e)}(e,t),r=e,(n=[{key:"render",value:function(t){var e=Math.PI/this.points;t.beginPath(),t.moveTo(this.x+this.radius*Math.cos(0),this.y-this.radius*Math.sin(0));for(var r=0;r<=2*this.points;r++){var n=r*e,o=r%2==0?this.radius:this.radius/2;t.lineTo(this.x+o*Math.cos(n),this.y-o*Math.sin(n))}t.closePath(),t.fillStyle=this.color,t.fill(),this.borderColor&&(t.strokeStyle=this.borderColor,t.lineWidth=this.borderWidth,t.stroke())}}])&&rr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function cr(t){return cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cr(t)}function fr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lr(n.key),n)}}function lr(t){var e=function(t){if("object"!=cr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=cr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==cr(e)?e:e+""}function sr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(sr=function(){return!!t})()}function yr(t){return yr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yr(t)}function hr(t,e){return hr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},hr(t,e)}var pr=function(t){function e(t){var r,n=t.image,o=t.x,i=t.y,u=t.width,a=t.height,c=t.repeatX,f=void 0===c?1:c,l=t.repeatY,s=void 0===l?1:l,y=t.spacingX,h=void 0===y?0:y,p=t.spacingY,b=void 0===p?0:p,v=t.preserveAspectRatio,d=void 0!==v&&v,m=t.enablePhysics,g=void 0!==m&&m,w=t.isStatic,x=void 0!==w&&w,O=t.layer,P=void 0===O?0:O;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,r){return e=yr(e),function(t,e){if(e&&("object"==cr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,sr()?Reflect.construct(e,r||[],yr(t).constructor):e.apply(t,r))}(this,e,[{x:o,y:i,width:u*f+h*(f-1),height:a*s+b*(s-1),color:null,enablePhysics:g,isStatic:x,layer:P}])).image=n,r.repeatX=f,r.repeatY=s,r.spacingX=h,r.spacingY=b,r.preserveAspectRatio=d,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hr(t,e)}(e,t),r=e,(n=[{key:"update",value:function(t){this.rigidBody&&(this.x=this.rigidBody.x,this.y=this.rigidBody.y)}},{key:"render",value:function(t){if(this.image.complete)for(var e=this.width/this.repeatX,r=this.height/this.repeatY,n=0;n<this.repeatX;n++)for(var o=0;o<this.repeatY;o++)t.drawImage(this.image,this.x+(e+this.spacingX)*n,this.y+(r+this.spacingY)*o,e,r)}}])&&fr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function br(t){return br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},br(t)}function vr(t){return function(t){if(Array.isArray(t))return dr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return dr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function mr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gr(n.key),n)}}function gr(t){var e=function(t){if("object"!=br(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=br(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==br(e)?e:e+""}function wr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(wr=function(){return!!t})()}function xr(t){return xr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xr(t)}function Or(t,e){return Or=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Or(t,e)}var Pr=function(t){function e(t,r,n,o,i){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(u=function(t,e,r){return e=xr(e),function(t,e){if(e&&("object"==br(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,wr()?Reflect.construct(e,r||[],xr(t).constructor):e.apply(t,r))}(this,e,[t,r,n,o,i])).vertices=[0,0,u.width,0,u.width,u.height,0,u.height],u.colors=[].concat(vr(u.color),[1],vr(u.color),[1],vr(u.color),[1],vr(u.color),[1]),u.vertexBuffer=null,u.colorBuffer=null,u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Or(t,e)}(e,t),r=e,(n=[{key:"initBuffers",value:function(t){this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertices),t.STATIC_DRAW),this.colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.colors),t.STATIC_DRAW)}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x,this.y,0,1]}},{key:"renderWebGL",value:function(t,e){this.vertexBuffer&&this.colorBuffer||this.initBuffers(t),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);var r=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer);var n=t.getAttribLocation(e,"aVertexColor");t.enableVertexAttribArray(n),t.vertexAttribPointer(n,4,t.FLOAT,!1,0,0);var o=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(o,!1,new Float32Array(this.getTransformationMatrix())),t.drawArrays(t.TRIANGLE_FAN,0,4)}}])&&mr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function Ar(t){return Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ar(t)}function jr(t){return function(t){if(Array.isArray(t))return Sr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Sr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Sr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Tr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Er(n.key),n)}}function Er(t){var e=function(t){if("object"!=Ar(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ar(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ar(e)?e:e+""}function _r(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_r=function(){return!!t})()}function Rr(t){return Rr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Rr(t)}function Br(t,e){return Br=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Br(t,e)}var Cr=function(t){function e(t,r,n){var o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,a=arguments.length>5?arguments[5]:void 0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=function(t,e,r){return e=Rr(e),function(t,e){if(e&&("object"==Ar(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,_r()?Reflect.construct(e,r||[],Rr(t).constructor):e.apply(t,r))}(this,e,[t,r,2*n,2*n,a])).radius=n,o.startAngle=i,o.endAngle=u,o.borderColor=c,o.borderWidth=f,o.vertices=o.calculateCircleVertices(),o.colors=[];for(var l=0;l<o.vertices.length/2;l++){var s;(s=o.colors).push.apply(s,jr(o.color).concat([1]))}return o.vertexBuffer=null,o.colorBuffer=null,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Br(t,e)}(e,t),r=e,n=[{key:"calculateCircleVertices",value:function(){var t=[];t.push(0,0);for(var e=this.startAngle;e<=this.endAngle;e+=(this.endAngle-this.startAngle)/100){var r=this.radius*Math.cos(e),n=this.radius*Math.sin(e);t.push(r,n)}return t}},{key:"initBuffers",value:function(t){this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertices),t.STATIC_DRAW),this.colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.colors),t.STATIC_DRAW)}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x,this.y,0,1]}},{key:"renderWebGL",value:function(t,e){this.vertexBuffer&&this.colorBuffer||this.initBuffers(t),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);var r=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer);var n=t.getAttribLocation(e,"aVertexColor");t.enableVertexAttribArray(n),t.vertexAttribPointer(n,4,t.FLOAT,!1,0,0);var o=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(o,!1,new Float32Array(this.getTransformationMatrix())),t.drawArrays(t.TRIANGLE_FAN,0,this.vertices.length/2)}},{key:"render",value:function(t){console.warn("render() is not implemented for WebGL Circle.")}}],n&&Tr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function kr(t){return kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kr(t)}function Fr(t){return function(t){if(Array.isArray(t))return Lr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Lr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ur(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mr(n.key),n)}}function Mr(t){var e=function(t){if("object"!=kr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=kr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==kr(e)?e:e+""}function Ir(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ir=function(){return!!t})()}function Dr(t){return Dr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Dr(t)}function Yr(t,e){return Yr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yr(t,e)}var Wr=function(t){function e(t,r,n,o){var i,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI,f=arguments.length>7?arguments[7]:void 0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e,r){return e=Dr(e),function(t,e){if(e&&("object"==kr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ir()?Reflect.construct(e,r||[],Dr(t).constructor):e.apply(t,r))}(this,e,[t,r,2*n,2*o,f])).rX=n,i.rY=o,i.rot=u,i.start=a,i.end=c,i.borderColor=l,i.borderWidth=s,i.vertices=i.calculateEllipseVertices(),i.colors=[];for(var y=0;y<i.vertices.length/2;y++){var h;(h=i.colors).push.apply(h,Fr(i.color).concat([1]))}return i.vertexBuffer=null,i.colorBuffer=null,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yr(t,e)}(e,t),r=e,n=[{key:"calculateEllipseVertices",value:function(){var t=[];t.push(0,0);for(var e=this.start;e<=this.end;e+=(this.end-this.start)/100){var r=this.rX*Math.cos(e)*Math.cos(this.rot)-this.rY*Math.sin(e)*Math.sin(this.rot),n=this.rX*Math.cos(e)*Math.sin(this.rot)+this.rY*Math.sin(e)*Math.cos(this.rot);t.push(r,n)}return t}},{key:"initBuffers",value:function(t){this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertices),t.STATIC_DRAW),this.colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.colors),t.STATIC_DRAW)}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x,this.y,0,1]}},{key:"renderWebGL",value:function(t,e){this.vertexBuffer&&this.colorBuffer||this.initBuffers(t),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);var r=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer);var n=t.getAttribLocation(e,"aVertexColor");t.enableVertexAttribArray(n),t.vertexAttribPointer(n,4,t.FLOAT,!1,0,0);var o=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(o,!1,new Float32Array(this.getTransformationMatrix())),t.drawArrays(t.TRIANGLE_FAN,0,this.vertices.length/2)}},{key:"render",value:function(t){console.warn("render() is not implemented for WebGL Ellipse.")}}],n&&Ur(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function Gr(t){return Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gr(t)}function Xr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vr(n.key),n)}}function Vr(t){var e=function(t){if("object"!=Gr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Gr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Gr(e)?e:e+""}function Nr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Nr=function(){return!!t})()}function zr(t){return zr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zr(t)}function qr(t,e){return qr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qr(t,e)}var $r=function(t){function e(t,r,n){var o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"black",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"Arial",c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=function(t,e,r){return e=zr(e),function(t,e){if(e&&("object"==Gr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Nr()?Reflect.construct(e,r||[],zr(t).constructor):e.apply(t,r))}(this,e,[r,n,0,0,u])).text=t,o.fontsize=i,o.fontFamily=a,o.borderColor=c,o.borderWidth=f,o.textCanvas=document.createElement("canvas"),o.textCanvasContext=o.textCanvas.getContext("2d"),o.texture=null,o.textureLoaded=!1,o.initTextTexture(),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qr(t,e)}(e,t),r=e,(n=[{key:"initTextTexture",value:function(){this.textCanvasContext.font="".concat(this.fontsize,"px ").concat(this.fontFamily);var t=this.textCanvasContext.measureText(this.text).width,e=1.5*this.fontsize;this.textCanvas.width=t,this.textCanvas.height=e,this.textCanvasContext.font="".concat(this.fontsize,"px ").concat(this.fontFamily),this.textCanvasContext.fillStyle=this.color,this.textCanvasContext.clearRect(0,0,this.textCanvas.width,this.textCanvas.height),this.textCanvasContext.fillText(this.text,0,this.fontsize),this.borderColor&&this.borderWidth>0&&(this.textCanvasContext.strokeStyle=this.borderColor,this.textCanvasContext.lineWidth=this.borderWidth,this.textCanvasContext.strokeText(this.text,0,this.fontsize)),this.textureLoaded=!1}},{key:"loadTexture",value:function(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.textCanvas),this.texture=e,this.textureLoaded=!0}},{key:"renderWebGL",value:function(t,e){if(this.textureLoaded||this.loadTexture(t),this.texture){t.bindTexture(t.TEXTURE_2D,this.texture);var r=[this.x,this.y,this.x+this.textCanvas.width,this.y,this.x+this.textCanvas.width,this.y+this.textCanvas.height,this.x,this.y+this.textCanvas.height],n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(r),t.STATIC_DRAW);var o=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(o),t.vertexAttribPointer(o,2,t.FLOAT,!1,0,0);var i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),t.STATIC_DRAW);var u=t.getAttribLocation(e,"aTextureCoord");t.enableVertexAttribArray(u),t.vertexAttribPointer(u,2,t.FLOAT,!1,0,0);var a=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(a,!1,new Float32Array(this.getTransformationMatrix())),t.drawArrays(t.TRIANGLE_FAN,0,4)}}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x,this.y,0,1]}}])&&Xr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function Kr(t){return Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kr(t)}function Hr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qr(n.key),n)}}function Qr(t){var e=function(t){if("object"!=Kr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Kr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Kr(e)?e:e+""}function Jr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Jr=function(){return!!t})()}function Zr(t){return Zr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zr(t)}function tn(t,e){return tn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tn(t,e)}var en=function(t){function e(t,r,n,o,i){var u,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(u=function(t,e,r){return e=Zr(e),function(t,e){if(e&&("object"==Kr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Jr()?Reflect.construct(e,r||[],Zr(t).constructor):e.apply(t,r))}(this,e,[r,n,o,i])).image=t,u.preserveAspectRatio=a,u.texture=null,u.textureLoaded=!1,u.image.onload=function(){u.textureLoaded=!1},u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tn(t,e)}(e,t),r=e,(n=[{key:"loadTexture",value:function(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.image),this.texture=e,this.textureLoaded=!0}},{key:"renderWebGL",value:function(t,e){if(this.textureLoaded||this.loadTexture(t),this.texture){t.bindTexture(t.TEXTURE_2D,this.texture);var r=this.width,n=this.height;if(this.preserveAspectRatio){var o=this.image.width/this.image.height;this.width/this.height>o?r=this.height*o:n=this.width/o}var i=[this.x,this.y,this.x+r,this.y,this.x+r,this.y+n,this.x,this.y+n],u=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW);var a=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(a),t.vertexAttribPointer(a,2,t.FLOAT,!1,0,0);var c=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,c),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),t.STATIC_DRAW);var f=t.getAttribLocation(e,"aTextureCoord");t.enableVertexAttribArray(f),t.vertexAttribPointer(f,2,t.FLOAT,!1,0,0);var l=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(l,!1,new Float32Array(this.getTransformationMatrix())),t.drawArrays(t.TRIANGLE_FAN,0,4)}}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x,this.y,0,1]}}])&&Hr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function rn(t){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rn(t)}function nn(t){return function(t){if(Array.isArray(t))return on(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return on(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?on(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function on(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function un(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,an(n.key),n)}}function an(t){var e=function(t){if("object"!=rn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=rn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==rn(e)?e:e+""}function cn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(cn=function(){return!!t})()}function fn(t){return fn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fn(t)}function ln(t,e){return ln=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ln(t,e)}var sn=function(t){function e(t,r,n,o,i){var u,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"butt";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(u=function(t,e,r){return e=fn(e),function(t,e){if(e&&("object"==rn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,cn()?Reflect.construct(e,r||[],fn(t).constructor):e.apply(t,r))}(this,e,[t,r,n-t,o-r,i])).x1=t,u.y1=r,u.x2=n,u.y2=o,u.color=i,u.widthline=a,u.lineRounded=c,u.vertices=[u.x1,u.y1,u.x2,u.y2],u.colors=[].concat(nn(u.color),[1],nn(u.color),[1]),u.vertexBuffer=null,u.colorBuffer=null,u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ln(t,e)}(e,t),r=e,(n=[{key:"initBuffers",value:function(t){this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertices),t.STATIC_DRAW),this.colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.colors),t.STATIC_DRAW)}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x1,this.y1,0,1]}},{key:"renderWebGL",value:function(t,e){this.vertexBuffer&&this.colorBuffer||this.initBuffers(t),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);var r=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer);var n=t.getAttribLocation(e,"aVertexColor");t.enableVertexAttribArray(n),t.vertexAttribPointer(n,4,t.FLOAT,!1,0,0);var o=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(o,!1,new Float32Array(this.getTransformationMatrix())),t.lineWidth(this.widthline),t.drawArrays(t.LINES,0,2)}},{key:"render",value:function(t){console.warn("render() is not implemented for WebGL Line.")}}])&&un(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function yn(t){return yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yn(t)}function hn(t){return function(t){if(Array.isArray(t))return pn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return pn(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function bn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vn(n.key),n)}}function vn(t){var e=function(t){if("object"!=yn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=yn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==yn(e)?e:e+""}function dn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(dn=function(){return!!t})()}function mn(t){return mn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mn(t)}function gn(t,e){return gn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},gn(t,e)}var wn=function(t){function e(t,r){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,r){return e=mn(e),function(t,e){if(e&&("object"==yn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,dn()?Reflect.construct(e,r||[],mn(t).constructor):e.apply(t,r))}(this,e,[t[0].x,t[0].y,0,0,r])).vertices=[],t.forEach((function(t){n.vertices.push(t.x-n.x,t.y-n.y)})),n.colors=[];for(var o=0;o<t.length;o++){var i;(i=n.colors).push.apply(i,hn(n.color).concat([1]))}return n.vertexBuffer=null,n.colorBuffer=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gn(t,e)}(e,t),r=e,(n=[{key:"initBuffers",value:function(t){this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertices),t.STATIC_DRAW),this.colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.colors),t.STATIC_DRAW)}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x,this.y,0,1]}},{key:"renderWebGL",value:function(t,e){this.vertexBuffer&&this.colorBuffer||this.initBuffers(t),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);var r=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer);var n=t.getAttribLocation(e,"aVertexColor");t.enableVertexAttribArray(n),t.vertexAttribPointer(n,4,t.FLOAT,!1,0,0);var o=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(o,!1,new Float32Array(this.getTransformationMatrix())),t.drawArrays(t.TRIANGLE_FAN,0,this.vertices.length/2)}}])&&bn(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function xn(t){return xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xn(t)}function On(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Pn(n.key),n)}}function Pn(t){var e=function(t){if("object"!=xn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=xn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==xn(e)?e:e+""}function An(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(An=function(){return!!t})()}function jn(t){return jn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},jn(t)}function Sn(t,e){return Sn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Sn(t,e)}var Tn=function(t){function e(t,r,n,o,i,u,a,c){var f,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"black",s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(f=function(t,e,r){return e=jn(e),function(t,e){if(e&&("object"==xn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,An()?Reflect.construct(e,r||[],jn(t).constructor):e.apply(t,r))}(this,e,[t,r,0,0,l])).startX=t,f.startY=r,f.controlX1=n,f.controlY1=o,f.controlX2=i,f.controlY2=u,f.endX=a,f.endY=c,f.color=l,f.widthline=s,f.numPoints=100,f.vertices=f.calculateBezierVertices(),f.vertexBuffer=null,f.colorBuffer=null,f}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sn(t,e)}(e,t),r=e,n=[{key:"calculateBezierVertices",value:function(){for(var t=[],e=0;e<=1;e+=1/this.numPoints){var r=Math.pow(1-e,3)*this.startX+3*Math.pow(1-e,2)*e*this.controlX1+3*(1-e)*Math.pow(e,2)*this.controlX2+Math.pow(e,3)*this.endX,n=Math.pow(1-e,3)*this.startY+3*Math.pow(1-e,2)*e*this.controlY1+3*(1-e)*Math.pow(e,2)*this.controlY2+Math.pow(e,3)*this.endY;t.push(r,n)}return t}},{key:"initBuffers",value:function(t){this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertices),t.STATIC_DRAW)}},{key:"renderWebGL",value:function(t,e){this.vertexBuffer||this.initBuffers(t),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);var r=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0);var n=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(n,!1,new Float32Array(this.getTransformationMatrix())),t.lineWidth(this.widthline),t.drawArrays(t.LINE_STRIP,0,this.vertices.length/2)}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x,this.y,0,1]}}],n&&On(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function En(t){return En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},En(t)}function _n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Rn(n.key),n)}}function Rn(t){var e=function(t){if("object"!=En(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=En(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==En(e)?e:e+""}function Bn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Bn=function(){return!!t})()}function Cn(t){return Cn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Cn(t)}function kn(t,e){return kn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},kn(t,e)}var Fn=function(t){function e(t,r,n,o){var i,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"black",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e,r){return e=Cn(e),function(t,e){if(e&&("object"==En(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Bn()?Reflect.construct(e,r||[],Cn(t).constructor):e.apply(t,r))}(this,e,[t,r,2*n,2*n,u])).radius=n,i.points=o,i.color=u,i.borderColor=a,i.borderWidth=c,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kn(t,e)}(e,t),r=e,(n=[{key:"render",value:function(t){var e=Math.PI/this.points;t.beginPath(),t.moveTo(this.x+this.radius*Math.cos(0),this.y-this.radius*Math.sin(0));for(var r=0;r<=2*this.points;r++){var n=r*e,o=r%2==0?this.radius:this.radius/2;t.lineTo(this.x+o*Math.cos(n),this.y-o*Math.sin(n))}t.closePath(),t.fillStyle=this.color,t.fill(),this.borderColor&&(t.strokeStyle=this.borderColor,t.lineWidth=this.borderWidth,t.stroke())}}])&&_n(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function Ln(t){return Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ln(t)}function Un(t){return function(t){if(Array.isArray(t))return Mn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Mn(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Mn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function In(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dn(n.key),n)}}function Dn(t){var e=function(t){if("object"!=Ln(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ln(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ln(e)?e:e+""}function Yn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Yn=function(){return!!t})()}function Wn(t){return Wn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Wn(t)}function Gn(t,e){return Gn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Gn(t,e)}var Xn=function(t){function e(t,r,n,o,i){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(u=function(t,e,r){return e=Wn(e),function(t,e){if(e&&("object"==Ln(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Yn()?Reflect.construct(e,r||[],Wn(t).constructor):e.apply(t,r))}(this,e,[t,r,n,o,i])).vertices=new Float32Array([0,0,u.width,0,u.width,u.height,0,u.height]),u.indices=new Uint16Array([0,1,2,0,2,3]),u.colors=new Float32Array([].concat(Un(u.color),[1],Un(u.color),[1],Un(u.color),[1],Un(u.color),[1])),u.vertexBuffer=null,u.colorBuffer=null,u.indexBuffer=null,u.transformBuffer=null,u.bindGroup=null,u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gn(t,e)}(e,t),r=e,(n=[{key:"getTransformationMatrix",value:function(){return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,this.x,this.y,0,1])}},{key:"initBuffers",value:function(t,e){this.vertexBuffer=t.createBuffer({size:this.vertices.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),t.queue.writeBuffer(this.vertexBuffer,0,this.vertices),this.indexBuffer=t.createBuffer({size:this.indices.byteLength,usage:GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST}),t.queue.writeBuffer(this.indexBuffer,0,this.indices),this.colorBuffer=t.createBuffer({size:this.colors.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),t.queue.writeBuffer(this.colorBuffer,0,this.colors),this.transformBuffer=t.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),t.queue.writeBuffer(this.transformBuffer,0,this.getTransformationMatrix()),this.bindGroup=t.createBindGroup({layout:e,entries:[{binding:0,resource:{buffer:this.transformBuffer}}]})}},{key:"renderWebGPU",value:function(t,e,r){this.vertexBuffer&&this.colorBuffer&&this.indexBuffer&&this.transformBuffer||this.initBuffers(t,r),t.queue.writeBuffer(this.transformBuffer,0,this.getTransformationMatrix()),e.setVertexBuffer(0,this.vertexBuffer),e.setVertexBuffer(1,this.colorBuffer),e.setIndexBuffer(this.indexBuffer,"uint16"),e.setBindGroup(0,this.bindGroup),e.drawIndexed(6,1,0,0,0)}}])&&In(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function Vn(t){return Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vn(t)}function Nn(t){return function(t){if(Array.isArray(t))return zn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return zn(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?zn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function qn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$n(n.key),n)}}function $n(t){var e=function(t){if("object"!=Vn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Vn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Vn(e)?e:e+""}function Kn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Kn=function(){return!!t})()}function Hn(t){return Hn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Hn(t)}function Qn(t,e){return Qn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Qn(t,e)}var Jn=function(t){function e(t,r,n){var o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,a=arguments.length>5?arguments[5]:void 0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=function(t,e,r){return e=Hn(e),function(t,e){if(e&&("object"==Vn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Kn()?Reflect.construct(e,r||[],Hn(t).constructor):e.apply(t,r))}(this,e,[t,r,2*n,2*n,a])).radius=n,o.startAngle=i,o.endAngle=u,o.borderColor=c,o.borderWidth=f,o.vertices=o.calculateCircleVertices(),o.colors=[];for(var l=0;l<o.vertices.length/2;l++){var s;(s=o.colors).push.apply(s,Nn(o.color).concat([1]))}return o.vertexBuffer=null,o.colorBuffer=null,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qn(t,e)}(e,t),r=e,n=[{key:"calculateCircleVertices",value:function(){var t=[];t.push(0,0);for(var e=this.startAngle;e<=this.endAngle;e+=(this.endAngle-this.startAngle)/100){var r=this.radius*Math.cos(e),n=this.radius*Math.sin(e);t.push(r,n)}return t}},{key:"initBuffers",value:function(t){this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertices),t.STATIC_DRAW),this.colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.colors),t.STATIC_DRAW)}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x,this.y,0,1]}},{key:"renderWebGL",value:function(t,e){this.vertexBuffer&&this.colorBuffer||this.initBuffers(t),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);var r=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer);var n=t.getAttribLocation(e,"aVertexColor");t.enableVertexAttribArray(n),t.vertexAttribPointer(n,4,t.FLOAT,!1,0,0);var o=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(o,!1,new Float32Array(this.getTransformationMatrix())),t.drawArrays(t.TRIANGLE_FAN,0,this.vertices.length/2)}},{key:"render",value:function(t){console.warn("render() is not implemented for WebGL Circle.")}}],n&&qn(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function Zn(t){return Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zn(t)}function to(t){return function(t){if(Array.isArray(t))return eo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return eo(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?eo(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eo(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ro(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,no(n.key),n)}}function no(t){var e=function(t){if("object"!=Zn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Zn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Zn(e)?e:e+""}function oo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(oo=function(){return!!t})()}function io(t){return io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},io(t)}function uo(t,e){return uo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},uo(t,e)}var ao=function(t){function e(t,r,n,o){var i,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI,f=arguments.length>7?arguments[7]:void 0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e,r){return e=io(e),function(t,e){if(e&&("object"==Zn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,oo()?Reflect.construct(e,r||[],io(t).constructor):e.apply(t,r))}(this,e,[t,r,2*n,2*o,f])).rX=n,i.rY=o,i.rot=u,i.start=a,i.end=c,i.borderColor=l,i.borderWidth=s,i.vertices=i.calculateEllipseVertices(),i.colors=[];for(var y=0;y<i.vertices.length/2;y++){var h;(h=i.colors).push.apply(h,to(i.color).concat([1]))}return i.vertexBuffer=null,i.colorBuffer=null,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uo(t,e)}(e,t),r=e,n=[{key:"calculateEllipseVertices",value:function(){var t=[];t.push(0,0);for(var e=this.start;e<=this.end;e+=(this.end-this.start)/100){var r=this.rX*Math.cos(e)*Math.cos(this.rot)-this.rY*Math.sin(e)*Math.sin(this.rot),n=this.rX*Math.cos(e)*Math.sin(this.rot)+this.rY*Math.sin(e)*Math.cos(this.rot);t.push(r,n)}return t}},{key:"initBuffers",value:function(t){this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertices),t.STATIC_DRAW),this.colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.colors),t.STATIC_DRAW)}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x,this.y,0,1]}},{key:"renderWebGL",value:function(t,e){this.vertexBuffer&&this.colorBuffer||this.initBuffers(t),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);var r=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer);var n=t.getAttribLocation(e,"aVertexColor");t.enableVertexAttribArray(n),t.vertexAttribPointer(n,4,t.FLOAT,!1,0,0);var o=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(o,!1,new Float32Array(this.getTransformationMatrix())),t.drawArrays(t.TRIANGLE_FAN,0,this.vertices.length/2)}},{key:"render",value:function(t){console.warn("render() is not implemented for WebGL Ellipse.")}}],n&&ro(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function co(t){return co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},co(t)}function fo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lo(n.key),n)}}function lo(t){var e=function(t){if("object"!=co(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=co(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==co(e)?e:e+""}function so(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(so=function(){return!!t})()}function yo(t){return yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yo(t)}function ho(t,e){return ho=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ho(t,e)}var po=function(t){function e(t,r,n){var o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"black",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"Arial",c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=function(t,e,r){return e=yo(e),function(t,e){if(e&&("object"==co(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,so()?Reflect.construct(e,r||[],yo(t).constructor):e.apply(t,r))}(this,e,[r,n,0,0,u])).text=t,o.fontsize=i,o.fontFamily=a,o.borderColor=c,o.borderWidth=f,o.textCanvas=document.createElement("canvas"),o.textCanvasContext=o.textCanvas.getContext("2d"),o.texture=null,o.textureLoaded=!1,o.initTextTexture(),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ho(t,e)}(e,t),r=e,(n=[{key:"initTextTexture",value:function(){this.textCanvasContext.font="".concat(this.fontsize,"px ").concat(this.fontFamily);var t=this.textCanvasContext.measureText(this.text).width,e=1.5*this.fontsize;this.textCanvas.width=t,this.textCanvas.height=e,this.textCanvasContext.font="".concat(this.fontsize,"px ").concat(this.fontFamily),this.textCanvasContext.fillStyle=this.color,this.textCanvasContext.clearRect(0,0,this.textCanvas.width,this.textCanvas.height),this.textCanvasContext.fillText(this.text,0,this.fontsize),this.borderColor&&this.borderWidth>0&&(this.textCanvasContext.strokeStyle=this.borderColor,this.textCanvasContext.lineWidth=this.borderWidth,this.textCanvasContext.strokeText(this.text,0,this.fontsize)),this.textureLoaded=!1}},{key:"loadTexture",value:function(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.textCanvas),this.texture=e,this.textureLoaded=!0}},{key:"renderWebGL",value:function(t,e){if(this.textureLoaded||this.loadTexture(t),this.texture){t.bindTexture(t.TEXTURE_2D,this.texture);var r=[this.x,this.y,this.x+this.textCanvas.width,this.y,this.x+this.textCanvas.width,this.y+this.textCanvas.height,this.x,this.y+this.textCanvas.height],n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(r),t.STATIC_DRAW);var o=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(o),t.vertexAttribPointer(o,2,t.FLOAT,!1,0,0);var i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),t.STATIC_DRAW);var u=t.getAttribLocation(e,"aTextureCoord");t.enableVertexAttribArray(u),t.vertexAttribPointer(u,2,t.FLOAT,!1,0,0);var a=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(a,!1,new Float32Array(this.getTransformationMatrix())),t.drawArrays(t.TRIANGLE_FAN,0,4)}}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x,this.y,0,1]}}])&&fo(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function bo(t){return bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bo(t)}function vo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mo(n.key),n)}}function mo(t){var e=function(t){if("object"!=bo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=bo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==bo(e)?e:e+""}function go(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(go=function(){return!!t})()}function wo(t){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wo(t)}function xo(t,e){return xo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},xo(t,e)}var Oo=function(t){function e(t,r,n,o,i){var u,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(u=function(t,e,r){return e=wo(e),function(t,e){if(e&&("object"==bo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,go()?Reflect.construct(e,r||[],wo(t).constructor):e.apply(t,r))}(this,e,[r,n,o,i])).image=t,u.preserveAspectRatio=a,u.texture=null,u.textureLoaded=!1,u.image.onload=function(){u.textureLoaded=!1},u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xo(t,e)}(e,t),r=e,(n=[{key:"loadTexture",value:function(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.image),this.texture=e,this.textureLoaded=!0}},{key:"renderWebGL",value:function(t,e){if(this.textureLoaded||this.loadTexture(t),this.texture){t.bindTexture(t.TEXTURE_2D,this.texture);var r=this.width,n=this.height;if(this.preserveAspectRatio){var o=this.image.width/this.image.height;this.width/this.height>o?r=this.height*o:n=this.width/o}var i=[this.x,this.y,this.x+r,this.y,this.x+r,this.y+n,this.x,this.y+n],u=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW);var a=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(a),t.vertexAttribPointer(a,2,t.FLOAT,!1,0,0);var c=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,c),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),t.STATIC_DRAW);var f=t.getAttribLocation(e,"aTextureCoord");t.enableVertexAttribArray(f),t.vertexAttribPointer(f,2,t.FLOAT,!1,0,0);var l=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(l,!1,new Float32Array(this.getTransformationMatrix())),t.drawArrays(t.TRIANGLE_FAN,0,4)}}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x,this.y,0,1]}}])&&vo(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function Po(t){return Po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Po(t)}function Ao(t){return function(t){if(Array.isArray(t))return jo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return jo(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?jo(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jo(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function So(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,To(n.key),n)}}function To(t){var e=function(t){if("object"!=Po(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Po(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Po(e)?e:e+""}function Eo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Eo=function(){return!!t})()}function _o(t){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_o(t)}function Ro(t,e){return Ro=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ro(t,e)}var Bo=function(t){function e(t,r,n,o,i){var u,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"butt";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(u=function(t,e,r){return e=_o(e),function(t,e){if(e&&("object"==Po(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Eo()?Reflect.construct(e,r||[],_o(t).constructor):e.apply(t,r))}(this,e,[t,r,n-t,o-r,i])).x1=t,u.y1=r,u.x2=n,u.y2=o,u.color=i,u.widthline=a,u.lineRounded=c,u.vertices=[u.x1,u.y1,u.x2,u.y2],u.colors=[].concat(Ao(u.color),[1],Ao(u.color),[1]),u.vertexBuffer=null,u.colorBuffer=null,u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ro(t,e)}(e,t),r=e,(n=[{key:"initBuffers",value:function(t){this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertices),t.STATIC_DRAW),this.colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.colors),t.STATIC_DRAW)}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x1,this.y1,0,1]}},{key:"renderWebGL",value:function(t,e){this.vertexBuffer&&this.colorBuffer||this.initBuffers(t),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);var r=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer);var n=t.getAttribLocation(e,"aVertexColor");t.enableVertexAttribArray(n),t.vertexAttribPointer(n,4,t.FLOAT,!1,0,0);var o=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(o,!1,new Float32Array(this.getTransformationMatrix())),t.lineWidth(this.widthline),t.drawArrays(t.LINES,0,2)}},{key:"render",value:function(t){console.warn("render() is not implemented for WebGL Line.")}}])&&So(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function Co(t){return Co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Co(t)}function ko(t){return function(t){if(Array.isArray(t))return Fo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Fo(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Fo(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fo(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Lo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Uo(n.key),n)}}function Uo(t){var e=function(t){if("object"!=Co(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Co(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Co(e)?e:e+""}function Mo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Mo=function(){return!!t})()}function Io(t){return Io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Io(t)}function Do(t,e){return Do=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Do(t,e)}var Yo=function(t){function e(t,r){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,r){return e=Io(e),function(t,e){if(e&&("object"==Co(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Mo()?Reflect.construct(e,r||[],Io(t).constructor):e.apply(t,r))}(this,e,[t[0].x,t[0].y,0,0,r])).vertices=[],t.forEach((function(t){n.vertices.push(t.x-n.x,t.y-n.y)})),n.colors=[];for(var o=0;o<t.length;o++){var i;(i=n.colors).push.apply(i,ko(n.color).concat([1]))}return n.vertexBuffer=null,n.colorBuffer=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Do(t,e)}(e,t),r=e,(n=[{key:"initBuffers",value:function(t){this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertices),t.STATIC_DRAW),this.colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.colors),t.STATIC_DRAW)}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x,this.y,0,1]}},{key:"renderWebGL",value:function(t,e){this.vertexBuffer&&this.colorBuffer||this.initBuffers(t),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);var r=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer);var n=t.getAttribLocation(e,"aVertexColor");t.enableVertexAttribArray(n),t.vertexAttribPointer(n,4,t.FLOAT,!1,0,0);var o=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(o,!1,new Float32Array(this.getTransformationMatrix())),t.drawArrays(t.TRIANGLE_FAN,0,this.vertices.length/2)}}])&&Lo(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function Wo(t){return Wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wo(t)}function Go(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xo(n.key),n)}}function Xo(t){var e=function(t){if("object"!=Wo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Wo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Wo(e)?e:e+""}function Vo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Vo=function(){return!!t})()}function No(t){return No=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},No(t)}function zo(t,e){return zo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},zo(t,e)}var qo=function(t){function e(t,r,n,o,i,u,a,c){var f,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"black",s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(f=function(t,e,r){return e=No(e),function(t,e){if(e&&("object"==Wo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Vo()?Reflect.construct(e,r||[],No(t).constructor):e.apply(t,r))}(this,e,[t,r,0,0,l])).startX=t,f.startY=r,f.controlX1=n,f.controlY1=o,f.controlX2=i,f.controlY2=u,f.endX=a,f.endY=c,f.color=l,f.widthline=s,f.numPoints=100,f.vertices=f.calculateBezierVertices(),f.vertexBuffer=null,f.colorBuffer=null,f}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zo(t,e)}(e,t),r=e,n=[{key:"calculateBezierVertices",value:function(){for(var t=[],e=0;e<=1;e+=1/this.numPoints){var r=Math.pow(1-e,3)*this.startX+3*Math.pow(1-e,2)*e*this.controlX1+3*(1-e)*Math.pow(e,2)*this.controlX2+Math.pow(e,3)*this.endX,n=Math.pow(1-e,3)*this.startY+3*Math.pow(1-e,2)*e*this.controlY1+3*(1-e)*Math.pow(e,2)*this.controlY2+Math.pow(e,3)*this.endY;t.push(r,n)}return t}},{key:"initBuffers",value:function(t){this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertices),t.STATIC_DRAW)}},{key:"renderWebGL",value:function(t,e){this.vertexBuffer||this.initBuffers(t),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);var r=t.getAttribLocation(e,"aVertexPosition");t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0);var n=t.getUniformLocation(e,"uTransform");t.uniformMatrix4fv(n,!1,new Float32Array(this.getTransformationMatrix())),t.lineWidth(this.widthline),t.drawArrays(t.LINE_STRIP,0,this.vertices.length/2)}},{key:"getTransformationMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,this.x,this.y,0,1]}}],n&&Go(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function $o(t){return $o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$o(t)}function Ko(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ho(n.key),n)}}function Ho(t){var e=function(t){if("object"!=$o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$o(e)?e:e+""}function Qo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Qo=function(){return!!t})()}function Jo(t){return Jo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jo(t)}function Zo(t,e){return Zo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Zo(t,e)}var ti=function(t){function e(t,r,n,o){var i,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"black",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e,r){return e=Jo(e),function(t,e){if(e&&("object"==$o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Qo()?Reflect.construct(e,r||[],Jo(t).constructor):e.apply(t,r))}(this,e,[t,r,2*n,2*n,u])).radius=n,i.points=o,i.color=u,i.borderColor=a,i.borderWidth=c,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zo(t,e)}(e,t),r=e,(n=[{key:"render",value:function(t){var e=Math.PI/this.points;t.beginPath(),t.moveTo(this.x+this.radius*Math.cos(0),this.y-this.radius*Math.sin(0));for(var r=0;r<=2*this.points;r++){var n=r*e,o=r%2==0?this.radius:this.radius/2;t.lineTo(this.x+o*Math.cos(n),this.y-o*Math.sin(n))}t.closePath(),t.fillStyle=this.color,t.fill(),this.borderColor&&(t.strokeStyle=this.borderColor,t.lineWidth=this.borderWidth,t.stroke())}}])&&Ko(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Jt);function ei(t){return console.log(t),function(t){if("2d"===t)return function(t){return{square:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new ie({x:e.x,y:e.y,width:e.size,height:e.size,color:r,borderColor:n,borderWidth:e.borderWidth,round:e.round,enablePhysics:e.enablePhysics||!1,isStatic:e.isStatic||!1,layer:e.layer||0})},rectangle:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new ie({x:e.x,y:e.y,width:e.width,height:e.height,color:r,borderColor:n,borderWidth:e.borderWidth,enablePhysics:e.enablePhysics||!1,isStatic:e.isStatic||!1,layer:e.layer||0})},circle:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new ye({x:e.x,y:e.y,radius:e.radius,color:r,borderColor:n,borderWidth:e.borderWidth,enablePhysics:e.enablePhysics||!1,isStatic:e.isStatic||!1,layer:e.layer||0})},arc:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new ye({x:e.x,y:e.y,radius:e.radius,startAngle:e.startAngle,endAngle:e.endAngle,color:r,borderColor:n,borderWidth:e.borderWidth,enablePhysics:e.enablePhysics||!1,isStatic:e.isStatic||!1,layer:e.layer||0})},ellipse:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new ge({x:e.x,y:e.y,radiusX:e.rX,radiusY:e.rY,rotation:e.rot||0,startAngle:e.start||0,endAngle:e.end||2*Math.PI,color:r,borderColor:n,borderWidth:e.borderWidth,enablePhysics:e.enablePhysics||!1,isStatic:e.isStatic||!1,layer:e.layer||0})},text:function(e){var r=Mt(e.color||"black",t),n=e.borderColor?Mt(e.borderColor,t):null;return new Se({text:e.text,x:e.x,y:e.y,fontSize:e.fontsize||16,fontFamily:e.fontFamily||"Arial",color:r,borderColor:n,borderWidth:e.borderWidth,enablePhysics:e.enablePhysics||!1,isStatic:e.isStatic||!1,layer:e.layer||0})},sprite:function(t){return new ke({image:t.image,x:t.x,y:t.y,width:t.width,height:t.height,preserveAspectRatio:t.preserveAspectRatio||!1,enablePhysics:t.enablePhysics||!1,isStatic:t.isStatic||!1,layer:t.layer||0})},spriteGrid:function(t){return new pr({image:t.image,x:t.x,y:t.y,width:t.width,height:t.height,repeatX:t.repeatX||1,repeatY:t.repeatY||1,spacingX:t.spacingX||0,spacingY:t.spacingY||0,preserveAspectRatio:t.preserveAspectRatio||!1,enablePhysics:t.enablePhysics||!1,isStatic:t.isStatic||!1,layer:t.layer||0})},line:function(e){var r=Mt(e.color||"black",t);return new Ye({x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,color:r,lineWidth:e.widthline||1,lineCap:e.lineRounded||"butt",enablePhysics:e.enablePhysics||!1,isStatic:e.isStatic||!1,layer:e.layer||0})},polygon:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new qe({vertices:e.vertices,color:r,borderColor:n,borderWidth:e.borderWidth,enablePhysics:e.enablePhysics||!1,isStatic:e.isStatic||!1,layer:e.layer||0})},bezierCurve:function(e){var r=Mt(e.color,t);return new tr({startX:e.startX,startY:e.startY,controlX1:e.controlX1,controlY1:e.controlY1,controlX2:e.controlX2,controlY2:e.controlY2,endX:e.endX,endY:e.endY,color:r,lineWidth:e.widthline||1,enablePhysics:e.enablePhysics||!1,isStatic:e.isStatic||!1,layer:e.layer||0})},star:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new ar({x:e.x,y:e.y,radius:e.radius,points:e.points,color:r,borderColor:n,borderWidth:e.borderWidth,enablePhysics:e.enablePhysics||!1,isStatic:e.isStatic||!1,layer:e.layer||0})},point:function(e){var r=Mt(e.color||"black",t);return new ye({x:e.x,y:e.y,radius:e.size||5,color:r,enablePhysics:e.enablePhysics||!1,isStatic:e.isStatic||!1,layer:e.layer||0})}}}(t);if("webgl"===t)return function(t){return console.log(t),{square:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new Pr(e.x,e.y,e.size,e.size,r,n,e.borderWidth,e.round)},rectangle:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return console.log(e.color),console.log(r),new Pr(e.x,e.y,e.width,e.height,r,n,e.borderWidth)},circle:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new Cr(e.x,e.y,e.radius,0,2*Math.PI,r,n,e.borderWidth)},arc:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new Cr(e.x,e.y,e.radius,e.startAngle,e.endAngle,r,n,e.borderWidth)},ellipse:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new Wr(e.x,e.y,e.rX,e.rY,e.rot||0,e.start||0,e.end||2*Math.PI,r,n,e.borderWidth)},text:function(e){var r=Mt(e.color||"black",t),n=e.borderColor?Mt(e.borderColor,t):null;return new $r(e.text,e.x,e.y,e.fontsize||16,r,e.fontFamily||"Arial",n,e.borderWidth)},sprite:function(t){return new en(t.image,t.x,t.y,t.width,t.height,t.preserveAspectRatio||!1)},line:function(e){var r=Mt(e.color||"black",t);return new sn(e.x1,e.y1,e.x2,e.y2,r,e.widthline||1,e.lineRounded||"butt")},polygon:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new wn(e.vertices,r,n,e.borderWidth)},bezierCurve:function(e){var r=Mt(e.color,t);return new Tn(e.startX,e.startY,e.controlX1,e.controlY1,e.controlX2,e.controlY2,e.endX,e.endY,r,e.widthline||1)},star:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new Fn(e.x,e.y,e.radius,e.points,r,n,e.borderWidth)},point:function(e){var r=Mt(e.color||"black",t);return new Cr(e.x,e.y,e.size||5,0,2*Math.PI,r)}}}(t);if("webgpu"===t)return function(t){return console.log(t),{square:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new Xn(e.x,e.y,e.size,e.size,r,n,e.borderWidth,e.round)},rectangle:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return console.log(e.color),console.log(r),new Xn(e.x,e.y,e.width,e.height,r,n,e.borderWidth)},circle:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new Jn(e.x,e.y,e.radius,0,2*Math.PI,r,n,e.borderWidth)},arc:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new Jn(e.x,e.y,e.radius,e.startAngle,e.endAngle,r,n,e.borderWidth)},ellipse:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new ao(e.x,e.y,e.rX,e.rY,e.rot||0,e.start||0,e.end||2*Math.PI,r,n,e.borderWidth)},text:function(e){var r=Mt(e.color||"black",t),n=e.borderColor?Mt(e.borderColor,t):null;return new po(e.text,e.x,e.y,e.fontsize||16,r,e.fontFamily||"Arial",n,e.borderWidth)},sprite:function(t){return new Oo(t.image,t.x,t.y,t.width,t.height,t.preserveAspectRatio||!1)},line:function(e){var r=Mt(e.color||"black",t);return new Bo(e.x1,e.y1,e.x2,e.y2,r,e.widthline||1,e.lineRounded||"butt")},polygon:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new Yo(e.vertices,r,n,e.borderWidth)},bezierCurve:function(e){var r=Mt(e.color,t);return new qo(e.startX,e.startY,e.controlX1,e.controlY1,e.controlX2,e.controlY2,e.endX,e.endY,r,e.widthline||1)},star:function(e){var r=Mt(e.color,t),n=e.borderColor?Mt(e.borderColor,t):null;return new ti(e.x,e.y,e.radius,e.points,r,n,e.borderWidth)},point:function(e){var r=Mt(e.color||"black",t);return new Jn(e.x,e.y,e.size||5,0,2*Math.PI,r)}}}(t);throw new Error("Unsupported render type: "+t)}(t)}function ri(t){return ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ri(t)}function ni(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oi(n.key),n)}}function oi(t){var e=function(t){if("object"!=ri(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ri(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ri(e)?e:e+""}var ii=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mousePosition={x:0,y:0},this.isClicked=!1,this.setupMouseControls(e)},(e=[{key:"setupMouseControls",value:function(t){var e=this;t.addEventListener("mousemove",(function(t){e.mousePosition={x:t.clientX,y:t.clientY}})),t.addEventListener("mousedown",(function(){e.isClicked=!0})),t.addEventListener("mouseup",(function(){e.isClicked=!1}))}},{key:"getMousePosition",value:function(){return this.mousePosition}},{key:"isMouseClicked",value:function(){return this.isClicked}},{key:"update",value:function(){}}])&&ni(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function ui(t){return ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ui(t)}function ai(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ci(n.key),n)}}function ci(t){var e=function(t){if("object"!=ui(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ui(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ui(e)?e:e+""}var fi=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.touchPosition={x:0,y:0},this.isTouched=!1,this.setupTouchControls(e)},(e=[{key:"setupTouchControls",value:function(t){var e=this;t.addEventListener("touchstart",(function(t){var r=t.touches[0];e.touchPosition={x:r.clientX,y:r.clientY},e.isTouched=!0})),t.addEventListener("touchmove",(function(t){var r=t.touches[0];e.touchPosition={x:r.clientX,y:r.clientY}})),t.addEventListener("touchend",(function(){e.isTouched=!1}))}},{key:"getTouchPosition",value:function(){return this.touchPosition}},{key:"isTouchActive",value:function(){return this.isTouched}},{key:"update",value:function(){}}])&&ai(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();return e})()));